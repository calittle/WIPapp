function logit(a){log[logi]=a,logi++}function showlog(){var a="";for(i=0;i<logi;i++)a=a+log[i]+"<br/>";window.open().document.write(a)}function updateBar(a){var b=new Date;$("#statusbar").text(b+" - "+a),logit(b+" - "+a)}function checkRequired(){updateBar("Checking required fields...");var a=document.getElementById("plugin"),b=!1;return null!=a&&(b=a.checkRequiredField()),updateBar("Required field check done ("+b+")"),b}function saveDocument(){updateBar("Saving...");var a="not saved",b=document.getElementById("plugin");if(null!=b){var c=1;do logit(new Date+" - trying plugin.cmdGetResponse(260) - "+c),a=b.cmdGetResponse(260),logit(new Date+" - returned ("+a+")"),c++;while("success"!=a&&c<10)}return updateBar("Document save result:"+a),"success"==a}function pageFormNav(a){var b=document.getElementById("plugin");if(null!=b)switch(a){case-2:b.FormPrevious();break;case-1:b.PagePrevious();break;case 1:b.PageNext();break;case 2:b.FormNext()}}function navBar(a){var b=document.getElementById("plugin");if(null!=b)switch(a){case-1:b.hideNavBar();break;case 1:b.showNavBar();break;case 0:b.toggleNavBar()}}function zoom(a){var b=document.getElementById("plugin");if(null!=b)switch(a){case-1:b.zoomOut();break;case 0:b.zoomNormal();break;case 1:b.zoomIn();break;default:b.zoomNormal()}}function positionContainer(){var a="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight;plugin.style.height=a-145+"px"}function browserDetect(){return(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||1==!!document.documentMode?"IE":"unknown"}function pluginDetect(){var a=browserDetect(),b=!1;if("Firefox"==a)for(var c=0;navigator.plugins[c];++c)"DocuMaker plugin"==navigator.plugins[c].name&&(b=!0);else if("IE"==a)try{new ActiveXObject("WIPED01.WipEd01Ctrl.1"),b=!0}catch(a){b=!1}return b}var log=[],logi=0;$(window).resize(positionContainer()),$(document).ready(function(){logit(new Date+" - WIPapp loaded; plugin may still be loading."),positionContainer(),isUserDocPrep&&($("#saveButton").prop("disabled",!1),logit(new Date+" - save button enabled (user is DocPrep)")),$("#saveButton").click(function(){$("#saveButton").prop("disabled",!0),$("#submitButton").prop("disabled",!0),saveDocument(),$("#saveButton").prop("disabled",!1),$("#submitButton").prop("disabled",!1)}),$("#zoomNormal").click(function(){zoom(0)}),$("#zoomOut").click(function(){zoom(-1)}),$("#zoomIn").click(function(){zoom(1)}),$("#formprev").click(function(){pageFormNav(-2)}),$("#formnext").click(function(){pageFormNav(2)}),$("#pageprev").click(function(){pageFormNav(-1)}),$("#pagenext").click(function(){pageFormNav(1)}),$("#navon").click(function(){navBar(1)}),$("#navoff").click(function(){navBar(-1)}),$("#navtoggle").click(function(){navBar(0)}),$("#proof").click(function(){saveDocument()&&(updateBar("Generating PDF..."),window.open("printwip?uniqueid="+uniqueid),updateBar("PDF generated and opened."))}),$("#checkRequired").click(function(){"true"==checkRequired()&&alert("All required fields are completed. Nice job!")}),$("#submitButton").click(function(){"true"==checkRequired()&&saveDocument()&&(updateBar("Submitting..."),window.location.replace("submitwip?uniqueid="+uniqueid+"&taskid="+taskid))}),$("#closeButton").click(function(){var a=document.getElementById("plugin");if(null!=a){var b="1";try{b=a.isdirty()}catch(a){b="1"}/^1$/.test(b)&&confirm("You may have unsaved data. Do you wish to close?")&&window.close()}}),0==pluginDetect()&&($("#saveButton").prop("disabled",!0),$("#submitButton").prop("disabled",!0))}),0==pluginDetect()&&(updateBar("No plugin installed! - Copyright (C) 2016-2017 Oracle Corporation."),alert("The Documaker plugin does not appear to be installed!"));